<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å…¬è·¯è·¯ç·šè¨­è¨ˆè¦ç¯„ - åœ–ç‰‡æŸ¥è©¢ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .img-container {
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }

        /* --- ç¸®æ”¾èˆ‡å°å¼•ç·šæ ¸å¿ƒæ¨£å¼ --- */
        #img-wrapper {
            position: relative;
            cursor: crosshair;
            overflow: hidden;
            touch-action: none; /* ç¦ç”¨é è¨­è¡Œç‚ºä»¥æ”¯æ´é›™æŒ‡ç¸®æ”¾ */
        }
        #display-img {
            transition: transform 0.05s linear;
            transform-origin: center center;
            user-select: none;
            -webkit-user-drag: none;
            pointer-events: none; /* ç”±å®¹å™¨çµ±ä¸€è™•ç†äº‹ä»¶ */
        }
        .guide-line {
            position: absolute;
            background-color: rgba(239, 68, 68, 0.7);
            pointer-events: none;
            display: none;
            z-index: 100;
        }
        .guide-h { width: 100%; height: 1px; left: 0; }
        .guide-v { width: 1px; height: 100%; top: 0; }
        .grabbing { cursor: grabbing !important; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen text-slate-900 font-sans">

    <nav class="bg-slate-900 text-white p-5 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-xl font-bold tracking-wider">å…¬è·¯è·¯ç·šè¨­è¨ˆè¦ç¯„</h1>
                <p class="text-xs text-slate-400 mt-1">112å¹´6æœˆä¿®è¨‚ç‰ˆ Â· åœ–è¡¨å¿«é€Ÿç´¢å¼•</p>
            </div>
            <button onclick="handleBack()" id="back-btn" class="hidden text-sm bg-blue-600 hover:bg-blue-500 px-5 py-2 rounded-full transition-all shadow-md">
                è¿”å›
            </button>
        </div>
    </nav>

    <main class="container mx-auto py-6 px-4">
        
        <div id="home-view" class="max-w-5xl mx-auto">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-extrabold text-slate-800 mb-4">åœ–è¡¨ç´¢å¼•ç›®éŒ„</h2>
                <div class="h-1 w-20 bg-blue-600 mx-auto rounded-full"></div>
            </div>

            <div class="mb-8 max-w-xl mx-auto relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
                <input type="text" id="search-input" oninput="handleSearch()" placeholder="è¼¸å…¥é—œéµå­—æˆ–ç·¨è™Ÿï¼ˆå¦‚ï¼šè¦–è·ã€3.4...ï¼‰" 
                    class="block w-full pl-10 pr-3 py-3 border border-slate-300 rounded-xl leading-5 bg-white shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none sm:text-sm transition-all">
                <div id="search-status" class="mt-2 text-xs text-slate-500 text-center hidden"></div>
            </div>

            <div id="accordion-container" class="space-y-4"></div>
            <div id="no-results" class="hidden text-center py-20 text-slate-400">æ‰¾ä¸åˆ°ç›¸ç¬¦çš„è¡¨æ ¼</div>
        </div>

        <div id="detail-view" class="hidden animate-fadeIn">
            <div class="max-w-6xl mx-auto">
                <div class="bg-white p-4 rounded-t-xl border-x border-t flex items-center justify-between">
                    <h2 id="view-title" class="text-sm md:text-lg font-bold text-slate-800 truncate mr-2"></h2>
                    <button onclick="resetZoom()" class="flex-shrink-0 text-xs bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded transition-colors">é‡è¨­æª¢è¦–</button>
                </div>
                
                <div id="img-wrapper" class="bg-slate-200 border border-slate-300 rounded-b-xl img-container flex justify-center items-center min-h-[450px] md:min-h-[600px]">
                    <div id="guide-h" class="guide-line guide-h"></div>
                    <div id="guide-v" class="guide-line guide-v"></div>
                    <img id="display-img" src="" alt="è¦ç¯„åœ–è¡¨" class="max-w-full shadow-2xl">
                </div>
                
                <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-slate-600 bg-white p-4 rounded-lg border">
                    <div class="flex items-center gap-2">
                        <span class="text-lg">ğŸ“±</span>
                        <p><strong>æ‰‹æ©Ÿï¼š</strong>é›™æŒ‡é–‹åˆç¸®æ”¾ï¼Œå–®æŒ‡æ»‘å‹•ç§»å‹•ï¼Œé•·æŒ‰åœ–ç‰‡åˆ‡æ›å°ç…§ç·šã€‚</p>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="text-lg">ğŸ’»</span>
                        <p><strong>é›»è…¦ï¼š</strong>æ»‘é¼ æ»¾è¼ªç¸®æ”¾ï¼Œå·¦éµæŒ‰ä½æ‹–æ›³ï¼Œé›™æ“Šåœ–ç‰‡åˆ‡æ›å°ç…§ç·šã€‚</p>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="py-10 text-center text-slate-400 text-sm">
        äº¤é€šéƒ¨é ’å¸ƒ Â· ä¸­è¯æ°‘åœ‹112å¹´6æœˆ
    </footer>

    <script>
        // --- å®Œæ•´è³‡æ–™åº« ---
        const sections = [
            {
                name: "ç¬¬ä¸€ç«  ç¸½å‰‡",
                items: [
                    { id: "1.4.1", title: "å…¬è·¯ç­‰ç´šèˆ‡è¨­è¨ˆé€Ÿç‡" },
                    { id: "1.5.1", title: "è¨­è¨ˆè»Šç¨®å„éƒ¨å°ºå¯¸" }
                ]
            },
            {
                name: "ç¬¬äºŒç«  æ©«æ–·é¢",
                items: [
                    { id: "2.2.1", title: "è¨­è¨ˆé€Ÿç‡èˆ‡æ¯è»Šé“å¯¬" },
                    { id: "2.3.1", title: "å…¬è·¯ç­‰ç´šèˆ‡è·¯è‚©å¯¬æœ€å°å¯¬åº¦" },
                    { id: "2.6.1", title: "å…¬è·¯ç­‰ç´šèˆ‡é‹ªé¢ç¨®é¡" },
                    { id: "2.6.2", title: "é‹ªé¢ç¨®é¡èˆ‡è·¯æ‹±" }
                ]
            },
            {
                name: "ç¬¬ä¸‰ç«  è¨­è¨ˆè¦ç´ ",
                items: [
                    { id: "3.1", title: "å¹³å‡è¡Œé§›é€Ÿç‡" },
                    { id: "3.2", title: "æ©«å‘æ‘©æ“¦ä¿‚æ•¸ fs" },
                    { id: "3.3.1.1", title: "æœ€çŸ­åœè»Šè¦–è·" },
                    { id: "3.3.1.2", title: "æœ€çŸ­è¶…è»Šè¦–è·" },
                    { id: "3.3.1.3", title: "æœ€çŸ­æ‡‰è®Šè¦–è·" },
                    { id: "3.3.2", title: "è¦–é»åŠç›®æ¨™ç‰©é«˜åº¦" },
                    { id: "3.4", title: "å¹³æ›²ç·šæœ€å°åŠå¾‘" },
                    { id: "3.5.1", title: "æœ€å¤§è¶…é«˜ç‡ emax" },
                    { id: "3.5.3.1", title: "ä¸»ç·šåŠåŒç’°é“è¶…é«˜ç‡ï¼ˆæ­£å¸¸è·¯æ‹± 1.5%æ™‚ï¼‰" },
                    { id: "3.5.3.2", title: "ä¸»ç·šåŠåŒç’°é“è¶…é«˜ç‡ï¼ˆæ­£å¸¸è·¯æ‹± 2.0%æ™‚ï¼‰" },
                    { id: "3.5.3.3", title: "å…¬è·¯é€šéå¸‚å€è¶…é«˜ç‡ï¼ˆæ­£å¸¸è·¯æ‹± 1.5%æ™‚ï¼‰" },
                    { id: "3.5.3.4", title: "å…¬è·¯é€šéå¸‚å€è¶…é«˜ç‡ï¼ˆæ­£å¸¸è·¯æ‹± 2.0%æ™‚ï¼‰" },
                    { id: "3.5.4", title: "æœ€å¤§è¶…é«˜æ¼¸è®Šç‡" },
                    { id: "3.5.6", title: "å…è¨­è¶…é«˜æ›²ç·šåŠå¾‘" },
                    { id: "3.6.2", title: "å…è¨­ç·©å’Œæ›²ç·šåŠå¾‘" },
                    { id: "3.8.1.1", title: "åŒå‘æ›²ç·šæœ€çŸ­é•·åº¦" },
                    { id: "3.8.1.2", title: "è¤‡æ›²ç·šæ¯ä¸€åœ“æ›²ç·šæ®µæœ€çŸ­é•·åº¦" },
                    { id: "3.9.1", title: "è»Šè¼›å°ºå¯¸ä¿‚æ•¸" },
                    { id: "3.9.2", title: "è»Šé“åŠ å¯¬å°ç…§è¡¨ï¼ˆå–®ä¸€è»Šé“å¯¬=3.0Mï¼‰" },
                    { id: "3.9.3", title: "è»Šé“åŠ å¯¬å°ç…§è¡¨ï¼ˆå–®ä¸€è»Šé“å¯¬=3.25Mï¼‰" },
                    { id: "3.9.4", title: "è»Šé“åŠ å¯¬å°ç…§è¡¨ï¼ˆå–®ä¸€è»Šé“å¯¬=3.50Mï¼‰" },
                    { id: "3.9.5", title: "è»Šé“åŠ å¯¬å°ç…§è¡¨ï¼ˆå–®ä¸€è»Šé“å¯¬=3.65Mï¼‰" },
                    { id: "3.10.2", title: "æœ€å¤§ç¸±å¡åº¦" },
                    { id: "3.10.3.3", title: "ç¸±å¡é•·åº¦é™åˆ¶" },
                    { id: "3.12", title: "åˆæˆå¡åº¦" },
                    { id: "3.13", title: "è±æ›²ç·šæœ€çŸ­é•·åº¦" }
                ]
            },
            {
                name: "ç¬¬å››ç«  äº¤å‰è™•èˆ‡äº¤æµé“",
                items: [
                    { id: "4.2.9.1", title: "è½‰å‘å½é“æœ€å°è¶…é«˜ç‡" },
                    { id: "4.2.9.2", title: "è½‰å‘å½é“åœ“æ›²ç·šæœ€çŸ­é•·åº¦" },
                    { id: "4.2.9.3", title: "è½‰å‘å½é“åˆ†åŒ¯æµå€æ©«å‘å¡å·®" },
                    { id: "4.2.9.4", title: "è½‰å‘å½é“è¨­è¨ˆäº¤é€šç‹€æ³" },
                    { id: "4.2.9.5", title: "è½‰å‘å½é“æœ€å°å…¨å¯¬" },
                    { id: "4.2.10.1", title: "æ¸›é€Ÿè»Šé“å¯¬åº¦æ¼¸è®Šæ¯”ä¾‹" },
                    { id: "4.2.10.2", title: "æœ€çŸ­æ¸›é€Ÿé•·åº¦" },
                    { id: "4.2.12.1", title: "ç’°å½¢äº¤å‰è¨­è¨ˆé€Ÿç‡" },
                    { id: "4.3.2.1", title: "ç«‹é«”äº¤å‰åˆ†åŒ¯æµä¸»ç·šæœ€å¤§ç¸±å¡åº¦" },
                    { id: "4.3.6.1", title: "åŒé“ç¸±å¡åº¦" },
                    { id: "4.3.8.1", title: "æ¸›é€Ÿé•·åº¦" },
                    { id: "4.3.8.4", title: "åŠ é€Ÿé•·åº¦" },
                    { id: "4.3.9", title: "é€£çºŒåŒé“é¼»ç«¯æœ€å°è·é›¢" }
                ]
            }
        ];

        // --- ä»‹é¢æ¸²æŸ“èˆ‡å°èˆª ---
        function renderAccordion(searchTerm = "") {
            const container = document.getElementById('accordion-container');
            const noResults = document.getElementById('no-results');
            const isSearching = searchTerm.trim() !== "";
            let totalMatchCount = 0;

            const html = sections.map(section => {
                const filteredItems = section.items.filter(item => 
                    item.id.includes(searchTerm) || item.title.toLowerCase().includes(searchTerm.toLowerCase())
                );
                if (filteredItems.length === 0) return "";
                totalMatchCount += filteredItems.length;
                return `
                    <details class="bg-white rounded-lg border border-slate-200 overflow-hidden shadow-sm" ${isSearching ? 'open' : ''}>
                        <summary class="flex justify-between items-center p-5 cursor-pointer hover:bg-slate-50">
                            <span class="text-lg font-bold text-slate-700">${section.name}</span>
                            <span class="text-xs text-slate-400 font-medium">${filteredItems.length} é …ç›®</span>
                        </summary>
                        <div class="p-4 bg-slate-50 border-t grid grid-cols-1 sm:grid-cols-2 gap-3">
                            ${filteredItems.map(img => `
                                <div onclick="navigateToImage('è¡¨/è¡¨${img.id}.png', 'è¡¨ ${img.id} - ${img.title}')" 
                                     class="bg-white p-3 rounded-md border shadow-sm hover:border-blue-400 cursor-pointer flex justify-between items-center group">
                                    <div class="truncate mr-2">
                                        <span class="text-blue-600 font-mono text-xs font-bold block mb-0.5">è¡¨ ${img.id}</span>
                                        <h3 class="text-sm font-semibold text-slate-700 truncate">${img.title}</h3>
                                    </div>
                                    <span class="text-slate-300 group-hover:text-blue-500">â¡ï¸</span>
                                </div>
                            `).join('')}
                        </div>
                    </details>
                `;
            }).join('');

            container.innerHTML = html;
            noResults.classList.toggle('hidden', totalMatchCount > 0 || !isSearching);
        }

        function handleSearch() { renderAccordion(document.getElementById('search-input').value); }
        function handleBack() { history.back(); }

        function updateUI(view, fileName = "", title = "") {
            const home = document.getElementById('home-view');
            const detail = document.getElementById('detail-view');
            const backBtn = document.getElementById('back-btn');
            const img = document.getElementById('display-img');
            
            if (view === 'detail') {
                img.src = fileName;
                document.getElementById('view-title').innerText = title;
                home.classList.add('hidden');
                detail.classList.remove('hidden');
                backBtn.classList.remove('hidden');
                resetZoom();
                window.scrollTo(0, 0);
            } else {
                home.classList.remove('hidden');
                detail.classList.add('hidden');
                backBtn.classList.add('hidden');
            }
        }

        function navigateToImage(f, t) {
            history.pushState({ view: 'detail', fileName: f, title: t }, "");
            updateUI('detail', f, t);
        }

        window.onpopstate = (e) => updateUI(e.state?.view || 'home', e.state?.fileName, e.state?.title);

        // --- æ ¸å¿ƒåŠŸèƒ½ï¼šç¸®æ”¾ã€æ‹–æ›³èˆ‡å°å¼•ç·šæ•´åˆ (æ”¯æ´è§¸æ§èˆ‡æ»‘é¼ ) ---
        const wrapper = document.getElementById('img-wrapper');
        const img = document.getElementById('display-img');
        const gH = document.getElementById('guide-h');
        const gV = document.getElementById('guide-v');

        let scale = 1, translateX = 0, translateY = 0;
        let isPanning = false, startX, startY;
        let evCache = []; // å¿«å–è§¸æ§é»
        let prevDiff = -1; // é›™æŒ‡è·é›¢
        let isGuideVisible = true;
        let longPressTimer;

        // é›»è…¦ç‰ˆæ»¾è¼ªç¸®æ”¾
        wrapper.addEventListener('wheel', (e) => {
            e.preventDefault();
            const delta = e.deltaY > 0 ? -0.15 : 0.15;
            scale = Math.min(Math.max(1, scale + delta), 6);
            updateTransform();
        }, { passive: false });

        // æŒ‡é‡äº‹ä»¶çµ±ä¸€è™•ç† (Pointer Events)
        wrapper.onpointerdown = (e) => {
            evCache.push(e);
            isPanning = true;
            startX = e.clientX - translateX;
            startY = e.clientY - translateY;
            wrapper.setPointerCapture(e.pointerId);
            
            // é•·æŒ‰åˆ¤æ–·
            longPressTimer = setTimeout(() => {
                isGuideVisible = !isGuideVisible;
                if(!isGuideVisible) { gH.style.display = gV.style.display = 'none'; }
            }, 500);
        };

        wrapper.onpointermove = (e) => {
            const index = evCache.findIndex(c => c.pointerId === e.pointerId);
            if (index !== -1) evCache[index] = e;

            // è™•ç†å°å¼•ç·šä½ç½® (èˆ‡ç¸®æ”¾å¹³ç§»ç¨ç«‹)
            const rect = wrapper.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            if (isGuideVisible && x >= 0 && x <= rect.width && y >= 0 && y <= rect.height) {
                gH.style.top = `${y}px`;
                gV.style.left = `${x}px`;
                gH.style.display = gV.style.display = 'block';
            } else {
                gH.style.display = gV.style.display = 'none';
            }

            // A. é›™æŒ‡ç¸®æ”¾
            if (evCache.length === 2) {
                clearTimeout(longPressTimer);
                const curDiff = Math.hypot(evCache[0].clientX - evCache[1].clientX, evCache[0].clientY - evCache[1].clientY);
                if (prevDiff > 0) {
                    const diff = curDiff - prevDiff;
                    scale = Math.min(Math.max(1, scale + diff * 0.015), 6);
                }
                prevDiff = curDiff;
                updateTransform();
            } 
            // B. å–®æŒ‡/æ»‘é¼ å¹³ç§»
            else if (isPanning) {
                if (Math.abs(e.clientX - (startX + translateX)) > 10) clearTimeout(longPressTimer);
                translateX = e.clientX - startX;
                translateY = e.clientY - startY;
                updateTransform();
            }
        };

        wrapper.onpointerup = wrapper.onpointerleave = (e) => {
            clearTimeout(longPressTimer);
            evCache = evCache.filter(c => c.pointerId !== e.pointerId);
            if (evCache.length < 2) prevDiff = -1;
            if (evCache.length === 0) isPanning = false;
        };

        // é›»è…¦ç‰ˆé›™æ“Šåˆ‡æ›
        wrapper.ondblclick = () => { isGuideVisible = !isGuideVisible; };

        function updateTransform() {
            img.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
        }

        function resetZoom() {
            scale = 1; translateX = 0; translateY = 0;
            updateTransform();
        }

        // åˆå§‹åŒ–æ¸²æŸ“
        renderAccordion();
        history.replaceState({ view: 'home' }, "");
    </script>
</body>
</html>